@{
    Layout = "_Layout";
}

<div class="flex flex-col min-h-screen md:flex-row">

    @await Html.PartialAsync("~/Views/Partials/_SidebarUser.cshtml")

    <div class="flex-1 p-4 md:p-0 flex flex-col">

        @await Html.PartialAsync("~/Views/Partials/_Header.cshtml")

        <!-- Search & Sort -->
        <div class="flex flex-col mt-4 md:flex-row md:items-center md:justify-between mb-6
                    space-y-4 md:space-y-0 mx-5 lg:mx-15">

            <input id="searchInput"
                   type="text"
                   placeholder="Search"
                   class="border px-4 py-2 rounded-md w-full md:w-40" />

            <div class="flex flex-col md:flex-row md:space-x-4 space-y-4 md:space-y-0
                        items-center w-full md:w-auto">

                <select id="sortSelect"
                        class="border px-4 py-2 rounded-md w-full md:w-auto">
                    <option value="localId-Ascending">ID (Ascending)</option>
                    <option value="localId-Descending">ID (Descending)</option>
                    <option value="customerName-Ascending">Name (A-Z)</option>
                    <option value="customerName-Descending">Name (Z-A)</option>
                    <option value="invoice_Date-Ascending">Date (Oldest)</option>
                    <option value="invoice_Date-Descending">Date (Newest)</option>
                    <option value="total_Amount-Ascending">Total (Low to High)</option>
                    <option value="total_Amount-Descending">Total (High to Low)</option>
                </select>

                <a href="/StockPages/AddSale"
                   class="bg-[#112D4E] text-white px-6 py-2 rounded-md
                          hover:bg-[#0b213f] w-full md:w-auto text-center">
                    Add Invoice
                </a>
            </div>
        </div>

        <!-- TABLE -->
        <div class="overflow-x-auto flex-grow lg:mx-15">
            <table class="min-w-full border-collapse border border-gray-300">
                <thead class="bg-[#112D4E] text-white">
                    <tr>
                        <th class="p-3">ID</th>
                        <th class="p-3">Customer Name</th>
                        <th class="p-3">Date</th>
                        <th class="p-3">Total</th>
                        <th class="p-3">Actions</th>
                    </tr>
                </thead>
                <tbody id="saleTable"></tbody>
            </table>
        </div>

        <!-- PAGINATION -->
        <div class="flex justify-center items-center space-x-4 mt-6">
            <button id="prevBtn" class="px-3 py-2 rounded">Previous</button>
            <p id="pageInfo" class="text-sm"></p>
            <button id="nextBtn" class="px-3 py-2 rounded">Next</button>
        </div>

        <!-- SUMMARY -->
        <div class="bg-[#112D4E] text-white p-2 rounded-md flex flex-col md:flex-row
                    justify-around items-center text-lg font-semibold mt-8
                    space-y-4 md:space-y-0 md:ml-10 md:mr-10 lg:ml-15 lg:mr-15 md:mb-8">
            <p id="totalInvoices"></p>
            <p id="totalAmount"></p>
        </div>
    </div>
</div>

<!-- DETAILS MODAL -->
<div id="detailsModal"
     class="fixed inset-0 flex justify-center items-center z-50 hidden md:ml-65">
    <div class="bg-white rounded-xl p-6 max-w-xl w-full shadow-lg relative">
        <h2 class="text-xl font-bold text-[#112D4E] border-b pb-2 mb-4">
            Sale Details
        </h2>
        <table class="w-full text-sm text-left">
            <thead>
                <tr class="font-semibold text-[#112D4E]">
                    <th>Product</th>
                    <th>Qty</th>
                    <th>Price</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody id="detailsTable"></tbody>
        </table>
        <button onclick="closeDetails()"
                class="absolute top-2 right-4 text-2xl font-bold text-[#112D4E] hover:text-red-500">
            ×
        </button>
    </div>
</div>

<!-- CONFIRM DELETE -->
<div id="confirmModal"
     class="fixed inset-0 flex items-center justify-center z-50 hidden md:ml-65">
    <div class="bg-white p-6 rounded-lg text-center space-y-4 w-96 shadow-lg border border-[#112D4E]">
        <div class="text-red-600 text-4xl">!</div>
        <h2 class="text-xl font-semibold">
            Are you sure you want to delete this invoice?
        </h2>
        <div class="flex justify-center space-x-4 mt-4">
            <button onclick="confirmDelete()"
                    class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">
                Yes, I'm sure
            </button>
            <button onclick="closeConfirm()"
                    class="border border-gray-400 px-6 py-2 rounded hover:bg-gray-100">
                No, cancel
            </button>
        </div>
    </div>
</div>

<!-- MESSAGE POPUP -->
<div id="messagePopup"
     class="fixed top-6 left-1/2 transform -translate-x-1/2
            text-white px-6 py-3 rounded-lg shadow-lg z-50 hidden md:ml-30">
    <span id="messageText"></span>
    <button onclick="closeMessage()" class="ml-4 font-bold">×</button>
</div>

<script src="~/js/components/sale.js"></script>
